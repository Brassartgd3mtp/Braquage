using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class PlayerInteractions : MonoBehaviour
{
    public static List<string> objectTag = new List<string>();
    [SerializeField] private InteractibleObjectV2 interactibleObject; //Script de l'objet interactif
    [SerializeField] private bool isKeyPressed = false;



    private void Start()
    {
        Invoke("SetupTags", 1f);
    }

    private void SetupTags()
    {
        objectTag.Add("Interactible");
        objectTag.Add("Goal");
    }

    void Update()
    {
        // Vérifie si une touche spécifique est enfoncée
        if (isKeyPressed && Input.GetKeyUp(KeyCode.Space))
        {
            if (interactibleObject != null)
            {
                // Appelle la méthode lorsque la touche est enfoncée
                interactibleObject.OnInteraction(gameObject);

            }
            else
            {
                Debug.LogError("InteractibleObject non trouvé sur l'objet.");
            }
        }
    }

    void OnTriggerEnter(Collider other)
    {
        if (objectTag.Contains(other.tag))
        {
            // Définis la variable pour permettre l'activation de la méthode
            isKeyPressed = true;

            interactibleObject = other.GetComponent<InteractibleObjectV2>();
        }
    }

    private void OnTriggerExit(Collider other)
    {
        SwitchKeyFalse();
    }

    void SwitchKeyFalse()
    {
        // Remets la variable à false pour ne pas répéter l'appel de la méthode
        isKeyPressed = false;

        //Vide la variable interactibleObject
        interactibleObject = null;
    }
}